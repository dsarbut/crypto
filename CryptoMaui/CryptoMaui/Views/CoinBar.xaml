<?xml version="1.0" encoding="utf-8" ?>
<ContentView
    x:Class="CryptoMaui.Views.CoinBar"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:viewModels="clr-namespace:CryptoMaui.ViewModels"
    x:DataType="viewModels:CoinSelectionViewModel">

    <Grid
        Padding="0"
        ColumnDefinitions="44, 17, *"
        HeightRequest="40"
        HorizontalOptions="Fill"
        RowDefinitions="22">
        <Border
            Grid.Column="0"
            Padding="0"
            BackgroundColor="{x:StaticResource Gray500}"
            HeightRequest="22"
            StrokeShape="RoundRectangle 15"
            StrokeThickness="2"
            WidthRequest="44">
            <Border.GestureRecognizers>
                <TapGestureRecognizer Command="{Binding SelectAllItemsCommand, Source={RelativeSource AncestorType={x:Type viewModels:CoinSelectionViewModel}}, x:DataType='viewModels:CoinSelectionViewModel'}" />
            </Border.GestureRecognizers>
            <Label
                Padding="0"
                FontSize="12"
                HorizontalOptions="Center"
                Text="All"
                VerticalOptions="Center" />
            <Border.Triggers>
                <DataTrigger
                    Binding="{Binding AllItemsSelected}"
                    TargetType="Border"
                    Value="True">
                    <Setter Property="Stroke" Value="{x:StaticResource Tertiary}" />
                </DataTrigger>
            </Border.Triggers>
        </Border>

        <BoxView
            Grid.Column="1"
            Margin="5,0,10,0"
            BackgroundColor="{x:StaticResource Gray500}"
            VerticalOptions="Fill"
            WidthRequest="2" />

        <CollectionView
            Grid.Column="2"
            HorizontalOptions="Fill"
            ItemSizingStrategy="MeasureAllItems"
            ItemsSource="{Binding Items}"
            SelectionMode="None"
            VerticalOptions="Fill">
            <CollectionView.ItemsLayout>
                <LinearItemsLayout Orientation="Horizontal" />
            </CollectionView.ItemsLayout>
            <CollectionView.ItemTemplate>
                <DataTemplate x:DataType="viewModels:CoinSelectionViewModelItem">
                    <Grid
                        Padding="0"
                        RowDefinitions="22"
                        RowSpacing="0">
                        <Border
                            Margin="5,0,0,0"
                            Padding="0"
                            StrokeShape="RoundRectangle 15"
                            StrokeThickness="2"
                            WidthRequest="44">
                            <Border.GestureRecognizers>
                                <TapGestureRecognizer Command="{Binding SelectItemCommand, Source={RelativeSource AncestorType={x:Type viewModels:CoinSelectionViewModel}}, x:DataType='viewModels:CoinSelectionViewModel'}" CommandParameter="{Binding .}" />
                            </Border.GestureRecognizers>

                            <Label
                                Padding="0"
                                FontSize="12"
                                HorizontalOptions="Center"
                                Text="{Binding Label}"
                                VerticalOptions="Center" />
                            <Border.Triggers>
                                <DataTrigger
                                    Binding="{Binding IsSelected}"
                                    TargetType="Border"
                                    Value="True">
                                    <Setter Property="Stroke" Value="{x:StaticResource Tertiary}" />
                                </DataTrigger>
                            </Border.Triggers>
                        </Border>
                    </Grid>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>
    </Grid>
</ContentView>
